<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>models/endboss.class.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BackgroundObject.html">BackgroundObject</a><ul class='methods'><li data-type='method'><a href="BackgroundObject.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="BackgroundObject.html#hit">hit</a></li><li data-type='method'><a href="BackgroundObject.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="BackgroundObject.html#isColliding">isColliding</a></li><li data-type='method'><a href="BackgroundObject.html#isDead">isDead</a></li><li data-type='method'><a href="BackgroundObject.html#isHurt">isHurt</a></li><li data-type='method'><a href="BackgroundObject.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="BackgroundObject.html#moveRight">moveRight</a></li><li data-type='method'><a href="BackgroundObject.html#playAnimation">playAnimation</a></li></ul></li><li></li><li><a href="Bottle.html">Bottle</a><ul class='methods'><li data-type='method'><a href="Bottle.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Bottle.html#hit">hit</a></li><li data-type='method'><a href="Bottle.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Bottle.html#isColliding">isColliding</a></li><li data-type='method'><a href="Bottle.html#isDead">isDead</a></li><li data-type='method'><a href="Bottle.html#isHurt">isHurt</a></li><li data-type='method'><a href="Bottle.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Bottle.html#moveRight">moveRight</a></li><li data-type='method'><a href="Bottle.html#playAnimation">playAnimation</a></li></ul></li><li></li><li><a href="Character.html">Character</a><ul class='methods'><li data-type='method'><a href="Character.html#animate">animate</a></li><li data-type='method'><a href="Character.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Character.html#bounceOnEnemy">bounceOnEnemy</a></li><li data-type='method'><a href="Character.html#enterSleepState">enterSleepState</a></li><li data-type='method'><a href="Character.html#exitSleepState">exitSleepState</a></li><li data-type='method'><a href="Character.html#handleAirState">handleAirState</a></li><li data-type='method'><a href="Character.html#handleDeadState">handleDeadState</a></li><li data-type='method'><a href="Character.html#handleHurtState">handleHurtState</a></li><li data-type='method'><a href="Character.html#handleIdleState">handleIdleState</a></li><li data-type='method'><a href="Character.html#handleJumpInput">handleJumpInput</a></li><li data-type='method'><a href="Character.html#handleWalkingState">handleWalkingState</a></li><li data-type='method'><a href="Character.html#hit">hit</a></li><li data-type='method'><a href="Character.html#hitByEndboss">hitByEndboss</a></li><li data-type='method'><a href="Character.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Character.html#isColliding">isColliding</a></li><li data-type='method'><a href="Character.html#isDead">isDead</a></li><li data-type='method'><a href="Character.html#isHurt">isHurt</a></li><li data-type='method'><a href="Character.html#jump">jump</a></li><li data-type='method'><a href="Character.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Character.html#moveRight">moveRight</a></li><li data-type='method'><a href="Character.html#playAnimation">playAnimation</a></li><li data-type='method'><a href="Character.html#resetSleepState">resetSleepState</a></li><li data-type='method'><a href="Character.html#resetStandingTime">resetStandingTime</a></li><li data-type='method'><a href="Character.html#startAnimationLoop">startAnimationLoop</a></li><li data-type='method'><a href="Character.html#startMovementLoop">startMovementLoop</a></li><li data-type='method'><a href="Character.html#stopSnoreIfNecessary">stopSnoreIfNecessary</a></li><li data-type='method'><a href="Character.html#stopWalkingSound">stopWalkingSound</a></li><li data-type='method'><a href="Character.html#updateAnimationState">updateAnimationState</a></li><li data-type='method'><a href="Character.html#updateCameraPosition">updateCameraPosition</a></li><li data-type='method'><a href="Character.html#updateHorizontalMovement">updateHorizontalMovement</a></li><li data-type='method'><a href="Character.html#updateWalkingSound">updateWalkingSound</a></li></ul></li><li></li><li><a href="Chicken.html">Chicken</a><ul class='methods'><li data-type='method'><a href="Chicken.html#animate">animate</a></li><li data-type='method'><a href="Chicken.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Chicken.html#hit">hit</a></li><li data-type='method'><a href="Chicken.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Chicken.html#isColliding">isColliding</a></li><li data-type='method'><a href="Chicken.html#isDead">isDead</a></li><li data-type='method'><a href="Chicken.html#isHurt">isHurt</a></li><li data-type='method'><a href="Chicken.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Chicken.html#moveRight">moveRight</a></li><li data-type='method'><a href="Chicken.html#playAnimation">playAnimation</a></li><li data-type='method'><a href="Chicken.html#playAnimationChickenDead">playAnimationChickenDead</a></li></ul></li><li></li><li><a href="Cloud.html">Cloud</a><ul class='methods'><li data-type='method'><a href="Cloud.html#animate">animate</a></li><li data-type='method'><a href="Cloud.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Cloud.html#hit">hit</a></li><li data-type='method'><a href="Cloud.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Cloud.html#isColliding">isColliding</a></li><li data-type='method'><a href="Cloud.html#isDead">isDead</a></li><li data-type='method'><a href="Cloud.html#isHurt">isHurt</a></li><li data-type='method'><a href="Cloud.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Cloud.html#moveRight">moveRight</a></li><li data-type='method'><a href="Cloud.html#playAnimation">playAnimation</a></li></ul></li><li></li><li><a href="Coin.html">Coin</a><ul class='methods'><li data-type='method'><a href="Coin.html#animate">animate</a></li><li data-type='method'><a href="Coin.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Coin.html#hit">hit</a></li><li data-type='method'><a href="Coin.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Coin.html#isColliding">isColliding</a></li><li data-type='method'><a href="Coin.html#isDead">isDead</a></li><li data-type='method'><a href="Coin.html#isHurt">isHurt</a></li><li data-type='method'><a href="Coin.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Coin.html#moveRight">moveRight</a></li><li data-type='method'><a href="Coin.html#playAnimation">playAnimation</a></li></ul></li><li></li><li><a href="DrawableObject.html">DrawableObject</a><ul class='methods'><li data-type='method'><a href="DrawableObject.html#draw">draw</a></li><li data-type='method'><a href="DrawableObject.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="DrawableObject.html#loadImage">loadImage</a></li><li data-type='method'><a href="DrawableObject.html#loadImages">loadImages</a></li></ul></li><li><a href="Endboss.html">Endboss</a><ul class='methods'><li data-type='method'><a href="Endboss.html#animate">animate</a></li><li data-type='method'><a href="Endboss.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="Endboss.html#chaseCharacter">chaseCharacter</a></li><li data-type='method'><a href="Endboss.html#endBossAnimation">endBossAnimation</a></li><li data-type='method'><a href="Endboss.html#hit">hit</a></li><li data-type='method'><a href="Endboss.html#hitEndBoss">hitEndBoss</a></li><li data-type='method'><a href="Endboss.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="Endboss.html#isColliding">isColliding</a></li><li data-type='method'><a href="Endboss.html#isDead">isDead</a></li><li data-type='method'><a href="Endboss.html#isDeadEndBoss">isDeadEndBoss</a></li><li data-type='method'><a href="Endboss.html#isHurt">isHurt</a></li><li data-type='method'><a href="Endboss.html#isHurtEndBoss">isHurtEndBoss</a></li><li data-type='method'><a href="Endboss.html#maybeTriggerJump">maybeTriggerJump</a></li><li data-type='method'><a href="Endboss.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="Endboss.html#moveRight">moveRight</a></li><li data-type='method'><a href="Endboss.html#playAnimation">playAnimation</a></li><li data-type='method'><a href="Endboss.html#startBehaviour">startBehaviour</a></li><li data-type='method'><a href="Endboss.html#updateAlertState">updateAlertState</a></li><li data-type='method'><a href="Endboss.html#updateAnimation">updateAnimation</a></li><li data-type='method'><a href="Endboss.html#updateAttackState">updateAttackState</a></li><li data-type='method'><a href="Endboss.html#updateBehaviour">updateBehaviour</a></li><li data-type='method'><a href="Endboss.html#updateFacingDirection">updateFacingDirection</a></li><li data-type='method'><a href="Endboss.html#updateJumpPosition">updateJumpPosition</a></li></ul></li><li></li><li><a href="Keyboard.html">Keyboard</a></li><li><a href="Level.html">Level</a></li><li></li><li><a href="MoveableObject.html">MoveableObject</a><ul class='methods'><li data-type='method'><a href="MoveableObject.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="MoveableObject.html#draw">draw</a></li><li data-type='method'><a href="MoveableObject.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="MoveableObject.html#hit">hit</a></li><li data-type='method'><a href="MoveableObject.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="MoveableObject.html#isColliding">isColliding</a></li><li data-type='method'><a href="MoveableObject.html#isDead">isDead</a></li><li data-type='method'><a href="MoveableObject.html#isHurt">isHurt</a></li><li data-type='method'><a href="MoveableObject.html#loadImage">loadImage</a></li><li data-type='method'><a href="MoveableObject.html#loadImages">loadImages</a></li><li data-type='method'><a href="MoveableObject.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="MoveableObject.html#moveRight">moveRight</a></li><li data-type='method'><a href="MoveableObject.html#playAnimation">playAnimation</a></li></ul></li><li><a href="SmallChicken.html">SmallChicken</a><ul class='methods'><li data-type='method'><a href="SmallChicken.html#animate">animate</a></li><li data-type='method'><a href="SmallChicken.html#playAnimationChickenDead">playAnimationChickenDead</a></li></ul></li><li><a href="SoundManager.html">SoundManager</a><ul class='methods'><li data-type='method'><a href="SoundManager.html#applyMuteStateToAll">applyMuteStateToAll</a></li><li data-type='method'><a href="SoundManager.html#playBackground">playBackground</a></li><li data-type='method'><a href="SoundManager.html#playBottlePickup">playBottlePickup</a></li><li data-type='method'><a href="SoundManager.html#playChickenDead">playChickenDead</a></li><li data-type='method'><a href="SoundManager.html#playCoinSound">playCoinSound</a></li><li data-type='method'><a href="SoundManager.html#playEndbossAlert">playEndbossAlert</a></li><li data-type='method'><a href="SoundManager.html#playEndbossAttack">playEndbossAttack</a></li><li data-type='method'><a href="SoundManager.html#playGameOver">playGameOver</a></li><li data-type='method'><a href="SoundManager.html#playGameWin">playGameWin</a></li><li data-type='method'><a href="SoundManager.html#playHurt">playHurt</a></li><li data-type='method'><a href="SoundManager.html#playJump">playJump</a></li><li data-type='method'><a href="SoundManager.html#playSmallChickenDead">playSmallChickenDead</a></li><li data-type='method'><a href="SoundManager.html#playSnore">playSnore</a></li><li data-type='method'><a href="SoundManager.html#playThrow">playThrow</a></li><li data-type='method'><a href="SoundManager.html#playWalking">playWalking</a></li><li data-type='method'><a href="SoundManager.html#setMuted">setMuted</a></li><li data-type='method'><a href="SoundManager.html#stopBackground">stopBackground</a></li><li data-type='method'><a href="SoundManager.html#stopEndbossSounds">stopEndbossSounds</a></li><li data-type='method'><a href="SoundManager.html#stopSnore">stopSnore</a></li><li data-type='method'><a href="SoundManager.html#stopWalking">stopWalking</a></li></ul></li><li></li><li><a href="StatusBar.html">StatusBar</a><ul class='methods'><li data-type='method'><a href="StatusBar.html#draw">draw</a></li><li data-type='method'><a href="StatusBar.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="StatusBar.html#loadImage">loadImage</a></li><li data-type='method'><a href="StatusBar.html#loadImages">loadImages</a></li><li data-type='method'><a href="StatusBar.html#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBar.html#setPercentage">setPercentage</a></li></ul></li><li></li><li><a href="StatusBarBoss.html">StatusBarBoss</a><ul class='methods'><li data-type='method'><a href="StatusBarBoss.html#draw">draw</a></li><li data-type='method'><a href="StatusBarBoss.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="StatusBarBoss.html#loadImage">loadImage</a></li><li data-type='method'><a href="StatusBarBoss.html#loadImages">loadImages</a></li><li data-type='method'><a href="StatusBarBoss.html#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarBoss.html#setPercentage">setPercentage</a></li></ul></li><li></li><li><a href="StatusBarBottle.html">StatusBarBottle</a><ul class='methods'><li data-type='method'><a href="StatusBarBottle.html#draw">draw</a></li><li data-type='method'><a href="StatusBarBottle.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="StatusBarBottle.html#loadImage">loadImage</a></li><li data-type='method'><a href="StatusBarBottle.html#loadImages">loadImages</a></li><li data-type='method'><a href="StatusBarBottle.html#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarBottle.html#setPercentage">setPercentage</a></li></ul></li><li></li><li><a href="StatusBarCoin.html">StatusBarCoin</a><ul class='methods'><li data-type='method'><a href="StatusBarCoin.html#draw">draw</a></li><li data-type='method'><a href="StatusBarCoin.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="StatusBarCoin.html#loadImage">loadImage</a></li><li data-type='method'><a href="StatusBarCoin.html#loadImages">loadImages</a></li><li data-type='method'><a href="StatusBarCoin.html#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarCoin.html#setPercentage">setPercentage</a></li></ul></li><li></li><li><a href="ThrowableObject.html">ThrowableObject</a><ul class='methods'><li data-type='method'><a href="ThrowableObject.html#applyGravity">applyGravity</a></li><li data-type='method'><a href="ThrowableObject.html#draw">draw</a></li><li data-type='method'><a href="ThrowableObject.html#drawFrame">drawFrame</a></li><li data-type='method'><a href="ThrowableObject.html#hit">hit</a></li><li data-type='method'><a href="ThrowableObject.html#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="ThrowableObject.html#isColliding">isColliding</a></li><li data-type='method'><a href="ThrowableObject.html#isDead">isDead</a></li><li data-type='method'><a href="ThrowableObject.html#isHurt">isHurt</a></li><li data-type='method'><a href="ThrowableObject.html#loadImage">loadImage</a></li><li data-type='method'><a href="ThrowableObject.html#loadImages">loadImages</a></li><li data-type='method'><a href="ThrowableObject.html#moveLeft">moveLeft</a></li><li data-type='method'><a href="ThrowableObject.html#moveRight">moveRight</a></li><li data-type='method'><a href="ThrowableObject.html#playAnimation">playAnimation</a></li><li data-type='method'><a href="ThrowableObject.html#throw">throw</a></li></ul></li><li></li><li><a href="World.html">World</a><ul class='methods'><li data-type='method'><a href="World.html#addObjectsToMap">addObjectsToMap</a></li><li data-type='method'><a href="World.html#addToMap">addToMap</a></li><li data-type='method'><a href="World.html#checkBottleHitsEndboss">checkBottleHitsEndboss</a></li><li data-type='method'><a href="World.html#checkCharacterDead">checkCharacterDead</a></li><li data-type='method'><a href="World.html#checkChickenKills">checkChickenKills</a></li><li data-type='method'><a href="World.html#checkCollisionCharacterBottle">checkCollisionCharacterBottle</a></li><li data-type='method'><a href="World.html#checkCollisionCharacterCoin">checkCollisionCharacterCoin</a></li><li data-type='method'><a href="World.html#checkCollisions">checkCollisions</a></li><li data-type='method'><a href="World.html#checkEndbossActivation">checkEndbossActivation</a></li><li data-type='method'><a href="World.html#checkEndbossDead">checkEndbossDead</a></li><li data-type='method'><a href="World.html#createGameOverlay">createGameOverlay</a></li><li data-type='method'><a href="World.html#draw">draw</a></li><li data-type='method'><a href="World.html#flipImage">flipImage</a></li><li data-type='method'><a href="World.html#flipImageBack">flipImageBack</a></li><li data-type='method'><a href="World.html#getBottleHitbox">getBottleHitbox</a></li><li data-type='method'><a href="World.html#getCharacterHitbox">getCharacterHitbox</a></li><li data-type='method'><a href="World.html#handleBottlePickup">handleBottlePickup</a></li><li data-type='method'><a href="World.html#handleThrowInput">handleThrowInput</a></li><li data-type='method'><a href="World.html#hitBoss">hitBoss</a></li><li data-type='method'><a href="World.html#isBottlePickupCollision">isBottlePickupCollision</a></li><li data-type='method'><a href="World.html#run">run</a></li><li data-type='method'><a href="World.html#setWorld">setWorld</a></li><li data-type='method'><a href="World.html#showLoseScreen">showLoseScreen</a></li><li data-type='method'><a href="World.html#showWinScreen">showWinScreen</a></li><li data-type='method'><a href="World.html#spawnBottle">spawnBottle</a></li><li data-type='method'><a href="World.html#updateBottleBar">updateBottleBar</a></li><li data-type='method'><a href="World.html#updateCoinBar">updateCoinBar</a></li></ul></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#canvas">canvas</a></li><li><a href="global.html#createLevel1">createLevel1</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initTouchControls">initTouchControls</a></li><li><a href="global.html#isMuted">isMuted</a></li><li><a href="global.html#keyboard">keyboard</a></li><li><a href="global.html#level1">level1</a></li><li><a href="global.html#resetGame">resetGame</a></li><li><a href="global.html#startGame">startGame</a></li><li><a href="global.html#toggleHelp">toggleHelp</a></li><li><a href="global.html#toggleMusic">toggleMusic</a></li><li><a href="global.html#touchControlsInitialized">touchControlsInitialized</a></li><li><a href="global.html#updateMusicButton">updateMusicButton</a></li><li><a href="global.html#world">world</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">models/endboss.class.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Defines the {@link Endboss} class.
 * Represents the final boss enemy in the game world.
 * The Endboss has multiple animation states (walking, alert, attack, hurt, dead)
 * and reacts to player interactions such as being hit by bottles.
 *
 * It uses a small state machine:
 *   - "idle"  → before first contact with the player
 *   - "alert" → short alert phase after first contact
 *   - "attack" → actively chases the player
 *
 * Additionally, during the attack phase the boss performs
 * occasional jump moves to make the fight more challenging.
 *
 * @extends MoveableObject
 * @see MoveableObject
 * @see World
 */

/**
 * Class representing the final boss enemy.
 * Extends {@link MoveableObject} and manages multiple animation states,
 * including walking, alert, attack, hurt, and death. The Endboss also
 * maintains its own health (`energyEndBoss`) and contact status.
 *
 * @class Endboss
 * @extends MoveableObject
 */
class Endboss extends MoveableObject {
    /**
     * The height of the Endboss sprite in pixels.
     * @type {number}
     */
    height = 400;

    /**
     * The width of the Endboss sprite in pixels.
     * @type {number}
     */
    width = 250;

    /**
     * The vertical position (Y-axis) of the Endboss on the canvas.
     * This value defines on which “ground level” the boss stands.
     * Adjust this if he appears too high or too low.
     * @type {number}
     */
    y = 45;

    /**
     * Stores the default ground Y position for the boss.
     * Used to reset his position after a jump.
     * @type {number}
     */
    baseY = 55;

    /**
     * Indicates whether the Endboss has already had its first contact
     * with the player character (starts alert → attack phase).
     * @type {boolean}
     */
    hadFirstContact = false;

    /**
     * Current health (energy) of the Endboss, ranging from 0 to 100.
     * When this reaches 0, the boss is considered dead.
     * @type {number}
     */
    energyEndBoss = 100;

    /**
     * Timestamp of the last hit received by the Endboss (in ms).
     * Used to calculate whether he is currently in the "hurt" state.
     * @type {number}
     */
    lastHitEndBoss = 0;

    /**
     * Current behaviour state of the Endboss.
     * - "idle"  → before first contact
     * - "alert" → short warning phase after first contact
     * - "attack" → actively chasing the player
     * @type {"idle" | "alert" | "attack"}
     */
    state = "idle";

    /**
     * Horizontal speed of the Endboss while chasing the player.
     * Increase to make the boss more aggressive.
     * @type {number}
     */
    attackSpeed = 3;

    /**
     * Minimum distance to the player where the boss stops moving closer.
     * This defines how “close” the boss will stand when attacking.
     * @type {number}
     */
    stopDistance = 30;

    /**
     * Duration of the alert phase in milliseconds.
     * After this time, the boss switches from "alert" to "attack".
     * @type {number}
     */
    alertDurationMs = 1200;

    /**
     * Timestamp of the last state change (idle/alert/attack).
     * Used to determine when to leave the alert state.
     * @type {number}
     */
    lastStateChangeAt = 0;

    /**
     * Interval ID for behaviour updates (movement + state changes).
     * @type {?number}
     */
    behaviourInterval = null;

    /**
     * Interval ID for animation updates (sprite frames only).
     * @type {?number}
     */
    animationInterval = null;

    /**
     * Flag to ensure behaviour intervals are only started once.
     * @type {boolean}
     */
    behaviourStarted = false;

    /**
     * Indicates whether the boss is currently performing a jump arc.
     * @type {boolean}
     */
    isJumping = false;

    /**
     * Maximum vertical jump height in pixels.
     * Higher value → higher jump.
     * @type {number}
     */
    jumpHeight = 80;

    /**
     * Total duration of a jump in milliseconds.
     * @type {number}
     */
    jumpDurationMs = 600;

    /**
     * Minimum time between two jumps in milliseconds.
     * @type {number}
     */
    jumpCooldownMs = 2000;

    /**
     * Timestamp when the current jump started (in ms).
     * @type {number}
     */
    jumpStartedAt = 0;

    /**
     * Timestamp of the last jump (in ms).
     * Used together with {@link jumpCooldownMs}.
     * @type {number}
     */
    lastJumpAt = 0;

    /**
     * Image paths for the walking animation sequence.
     * @type {string[]}
     */
    IMAGES_WALKING = [
        'img/4_enemie_boss_chicken/1_walk/G1.png',
        'img/4_enemie_boss_chicken/1_walk/G2.png',
        'img/4_enemie_boss_chicken/1_walk/G3.png',
        'img/4_enemie_boss_chicken/1_walk/G4.png'
    ];

    /**
     * Image paths for the alert animation sequence.
     * @type {string[]}
     */
    IMAGES_ALERT = [
        'img/4_enemie_boss_chicken/2_alert/G5.png',
        'img/4_enemie_boss_chicken/2_alert/G6.png',
        'img/4_enemie_boss_chicken/2_alert/G7.png',
        'img/4_enemie_boss_chicken/2_alert/G8.png',
        'img/4_enemie_boss_chicken/2_alert/G9.png',
        'img/4_enemie_boss_chicken/2_alert/G10.png',
        'img/4_enemie_boss_chicken/2_alert/G11.png',
        'img/4_enemie_boss_chicken/2_alert/G12.png'
    ];

    /**
     * Image paths for the attack animation sequence.
     * @type {string[]}
     */
    IMAGES_ATTACK = [
        'img/4_enemie_boss_chicken/3_attack/G13.png',
        'img/4_enemie_boss_chicken/3_attack/G14.png',
        'img/4_enemie_boss_chicken/3_attack/G15.png',
        'img/4_enemie_boss_chicken/3_attack/G16.png',
        'img/4_enemie_boss_chicken/3_attack/G17.png',
        'img/4_enemie_boss_chicken/3_attack/G18.png',
        'img/4_enemie_boss_chicken/3_attack/G19.png',
        'img/4_enemie_boss_chicken/3_attack/G20.png'
    ];

    /**
     * Image paths for the hurt animation sequence.
     * @type {string[]}
     */
    IMAGES_HURT = [
        'img/4_enemie_boss_chicken/4_hurt/G21.png',
        'img/4_enemie_boss_chicken/4_hurt/G22.png',
        'img/4_enemie_boss_chicken/4_hurt/G23.png'
    ];

    /**
     * Image paths for the dead animation sequence.
     * @type {string[]}
     */
    IMAGES_DEAD = [
        'img/4_enemie_boss_chicken/5_dead/G24.png',
        'img/4_enemie_boss_chicken/5_dead/G25.png',
        'img/4_enemie_boss_chicken/5_dead/G26.png'
    ];

    /**
     * Creates a new {@link Endboss} instance.
     * Loads all animation images, initializes speed and position,
     * and starts the behaviour and animation loops.
     *
     * The boss does NOT use gravity here and stays on a fixed Y-level
     * defined by {@link Endboss#y}. Jumps are animated by temporarily
     * modifying his Y-position and then returning to {@link baseY}.
     *
     * @constructor
     */
    constructor() {
        super().loadImage(this.IMAGES_WALKING[0]);
        this.loadImages(this.IMAGES_WALKING);
        this.loadImages(this.IMAGES_ALERT);
        this.loadImages(this.IMAGES_ATTACK);
        this.loadImages(this.IMAGES_HURT);
        this.loadImages(this.IMAGES_DEAD);

        this.x = 2500;
        this.baseY = this.y;
        this.speed = this.attackSpeed;

        this.startBehaviour();
    }

    /**
     * Reduces the Endboss's energy by a fixed amount (10) when hit.
     * If energy drops below zero, it is clamped to zero.
     * Also records the timestamp of the hit for the "hurt" animation.
     *
     * @returns {void}
     */
    hitEndBoss() {
        this.energyEndBoss -= 10;
        if (this.energyEndBoss &lt; 0) {
            this.energyEndBoss = 0;
        } else {
            this.lastHitEndBoss = Date.now();
        }
    }

    /**
     * Determines whether the Endboss has been hit recently.
     * Used to trigger the "hurt" animation state.
     *
     * @returns {boolean} True if the Endboss was hit within the last second.
     */
    isHurtEndBoss() {
        return Date.now() - this.lastHitEndBoss &lt; 1000;
    }

    /**
     * Checks whether the Endboss is dead (energy has reached 0).
     *
     * @returns {boolean} True if the Endboss's energy is zero or below.
     */
    isDeadEndBoss() {
        return this.energyEndBoss &lt;= 0;
    }

    /**
     * Called when the player enters the boss arena.
     * Switches the boss from "idle" into the "alert" state and
     * starts the alert timer.
     *
     * @returns {void}
     */
    endBossAnimation() {
        this.hadFirstContact = true;
        this.state = "alert";
        this.lastStateChangeAt = Date.now();
    }

    /**
     * Backwards compatibility wrapper.
     * In older versions, {@link Endboss#animate} started the boss behaviour.
     * Now it just calls {@link Endboss#startBehaviour}.
     *
     * @returns {void}
     */
    animate() {
        this.startBehaviour();
    }

    /**
     * Starts movement and animation loops.
     * Ensures they are only started once.
     *
     * @returns {void}
     */
    startBehaviour() {
        if (this.behaviourStarted) return;
        this.behaviourStarted = true;

        this.behaviourInterval = setInterval(
            () => this.updateBehaviour(),
            1000 / 60
        );

        this.animationInterval = setInterval(
            () => this.updateAnimation(),
            125
        );
    }

    /**
     * Updates Endboss state (idle, alert, attack), movement,
     * and vertical jump position.
     * Also safely looks up the global {@link world} instance.
     *
     * @returns {void}
     */
    updateBehaviour() {
        if (this.isDeadEndBoss()) return;

        let character = null;
        if (typeof world !== 'undefined' &amp;&amp; world &amp;&amp; world.character) {
            character = world.character;
        }
        if (!character || !this.hadFirstContact) return;

        const now = Date.now();

        this.updateJumpPosition(now);

        if (this.state === "alert") {
            this.updateAlertState(now);
            return;
        }

        if (this.state === "attack") {
            this.updateAttackState(character, now);
        }
    }

    /**
     * Handles the transition from "alert" to "attack".
     *
     * @param {number} now - Current timestamp in ms.
     * @returns {void}
     */
    updateAlertState(now) {
        const elapsed = now - this.lastStateChangeAt;
        if (elapsed &lt; this.alertDurationMs) return;
        this.state = "attack";
        this.lastStateChangeAt = now;
    }

    /**
     * Updates the boss behaviour while in "attack" state:
     * facing direction, chasing and jump attempts.
     *
     * @param {Character} character - The player character.
     * @param {number} now - Current timestamp in ms.
     * @returns {void}
     */
    updateAttackState(character, now) {
        const dx = character.x - this.x;
        const distance = Math.abs(dx);
        const movingRight = dx > 0;

        this.updateFacingDirection(movingRight);
        this.chaseCharacter(distance, movingRight);
        this.maybeTriggerJump(distance, now);
    }

    /**
     * Updates the sprite flip based on movement direction.
     *
     * @param {boolean} movingRight - True if the boss moves to the right.
     * @returns {void}
     */
    updateFacingDirection(movingRight) {
        this.otherDirection = movingRight;
    }

    /**
     * Moves the boss horizontally towards the player
     * until {@link stopDistance} is reached.
     *
     * @param {number} distance - Horizontal distance to the character.
     * @param {boolean} movingRight - True if the character is to the right.
     * @returns {void}
     */
    chaseCharacter(distance, movingRight) {
        if (distance &lt;= this.stopDistance) return;
        const step = this.attackSpeed;
        this.x += movingRight ? step : -step;
    }


    /**
     * Updates the boss' Y-position while a jump is active.
     * Uses a smooth sine curve for the jump arc.
     *
     * @param {number} now - Current timestamp in ms.
     * @returns {void}
     */
    updateJumpPosition(now) {
        if (!this.isJumping) {
            this.y = this.baseY;
            return;
        }

        const elapsed = now - this.jumpStartedAt;
        const t = elapsed / this.jumpDurationMs;

        if (t >= 1) {
            this.isJumping = false;
            this.y = this.baseY;
            return;
        }

        const jumpOffset = Math.sin(Math.PI * t) * this.jumpHeight;
        this.y = this.baseY - jumpOffset;
    }

    /**
     * Decides whether the boss should start a jump.
     * Conditions:
     *  - boss is not already jumping,
     *  - cooldown has passed,
     *  - player is within a reasonable horizontal distance.
     *
     * @param {number} distance - Horizontal distance to the player.
     * @param {number} now - Current timestamp in ms.
     * @returns {void}
     */
    maybeTriggerJump(distance, now) {
        if (this.isJumping) return;
        if (now - this.lastJumpAt &lt; this.jumpCooldownMs) return;
        if (distance &lt; 100 || distance > 450) return;

        this.isJumping = true;
        this.jumpStartedAt = now;
        this.lastJumpAt = now;
    }

    /**
     * Plays the correct animation based on the current boss state and damage.
     *
     * Priority:
     *  1. Dead
     *  2. Hurt
     *  3. Idle (before contact)
     *  4. Alert
     *  5. Attack
     *
     * @returns {void}
     */
    updateAnimation() {
        if (this.isDeadEndBoss()) {
            this.playAnimation(this.IMAGES_DEAD);
            return;
        }

        if (this.isHurtEndBoss()) {
            this.playAnimation(this.IMAGES_HURT);
            return;
        }

        if (!this.hadFirstContact) {
            this.playAnimation(this.IMAGES_WALKING);
            return;
        }

        if (this.state === "alert") {
            this.playAnimation(this.IMAGES_ALERT);
            return;
        }

        this.playAnimation(this.IMAGES_ATTACK);
    }

}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
